function GM11
% 灰色预测 GM(1, 1)模型，比较适合指数趋势的数据
%

close all;
Y0 = [8353,5091,3052]; % 原始数据
Y1 = cumsum(Y0);
X = Y0(2 : end)';
N = length(Y0);
B = zeros(N - 1, 2);
for i = 1 : N - 1
    B(i, 1) = -0.5 * (Y1(i) + Y1(i + 1));
    B(i, 2) = 1;
end
alB = inv(B'*B)*B'*X;
alpha = alB(1);
mu= alB(2);

Y2 = zeros(1, N + 1);
Y2(1) = Y0(1);
for i = 2 : N + 1
    Y2(i) = (Y0(1) - mu/alpha) * exp(-alpha * (i-1)) + mu/alpha;
end
foreValue = zeros(1, N + 1);
foreValue(1) = Y0(1);
for i = 2 : N + 1
    foreValue(i) = Y2(i) - Y2(i - 1);
end
fprintf('forecast value is %.2f\n', foreValue(end));

%绘制曲线图
t1 = 1 : N;
t2 = 1 : N + 1;

Y0= [8353,5091,3052]
foreValue = [8353, 8353, 7048, 5449];
plot(t1, Y0,'ro'); hold on;
plot(t2, foreValue, 'g-');
legend('实际数据','预测数据');
xlim([1 5]);
ylim([0 9000]);
grid on;
end


x = [970062	18718.3	103922	5560.1	8300.1	6955.81
985793	21826.2	104844	7225.8	9415.6	9810.4
1045899	26937.3	107256	9119.6	10993.7	12443.12
1115902	35260	111059	11271	14270.4	14410.22
1180396	48108.5	118729	20381.9	18622.9	17042.94
1234938	59810.5	129034	23499.9	23613.8	20019.3
1298421	70142.5	133032	24133.8	28360.2	22974
1278218	78060.9	133460	26967.2	31252.9	24941.1
1267427	83024.3	129834	26849.7	33378.1	28406.2
1293008	88479.2	131935	29896.2	35647.9	29854.7
1358682	98000.5	135048	39273.2	39105.7	32917.7
1401786	108068.2	143875	42183.6	43055.4	37213.5
1483447	119095.7	150656	51378.2	48135.9	43499.9
1564492	134977	171906	70483.5	52516.3	55566.6
1706412	159453.6	196648	95539.1	59501	70477.43
1862066	183617.4	216219	116921.8	67176.6	88773.61
2037060	215904.4	232167	140974	76410	109998.16
2275822	266422	242279	166863.7	89210	137323.94
2585973	316030.3	260552	179921.5	108487.7	172828.4
2825222	340320	274619	150648.1	132678.4	224598.77
3241807	399759.5	296916	201722.1	156998.4	278121.85
3696961	472115	317987	236402	183918.6	311485.13];